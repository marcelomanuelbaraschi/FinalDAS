<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
		xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
		xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
	
	<!-- ***************************** -->
	<!--  DROP PROCEDURES CHANGE-SETS  -->
	<!-- ***************************** -->
	
	<changeSet id="Drop procedure cleanDB" author="DAS-Team" runAlways="true"
	           runOnChange="true">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="1">
				SELECT COUNT(*)
				FROM information_schema.routines
				WHERE ROUTINE_TYPE = 'PROCEDURE'
				AND SPECIFIC_CATALOG = 'db_indec_service'
				AND ROUTINE_NAME = 'cleanDB'
			</sqlCheck>
		</preConditions>
		<dropProcedure procedureName="cleanDB"/>
	</changeSet>

	<changeSet id="Drop procedure spCadenasServicesConfigs" author="DAS-Team" runAlways="true"
			   runOnChange="true">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="1">
				SELECT COUNT(*)
				FROM information_schema.routines
				WHERE ROUTINE_TYPE = 'PROCEDURE'
				AND SPECIFIC_CATALOG = 'db_indec_service'
				AND ROUTINE_NAME = 'spCadenasServicesConfigs'
			</sqlCheck>
		</preConditions>
		<dropProcedure procedureName="spCadenasServicesConfigs"/>
	</changeSet>

	<changeSet id="Drop procedure spCategoriasProducto" author="DAS-Team" runAlways="true"
			   runOnChange="true">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="1">
				SELECT COUNT(*)
				FROM information_schema.routines
				WHERE ROUTINE_TYPE = 'PROCEDURE'
				AND SPECIFIC_CATALOG = 'db_indec_service'
				AND ROUTINE_NAME = 'spCategoriasProducto'
			</sqlCheck>
		</preConditions>
		<dropProcedure procedureName="spCategoriasProducto"/>
	</changeSet>


	<!-- ******************************* -->
	<!--  CREATE PROCEDURES CHANGE-SETS  -->
	<!-- ******************************* -->
	
	<changeSet id="Create procedure cleanDB" author="DAS-Team" runAlways="true"
	           runOnChange="true">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">
				SELECT COUNT(*)
				FROM information_schema.routines
				WHERE ROUTINE_TYPE = 'PROCEDURE'
				AND SPECIFIC_CATALOG = 'db_indec_service'
				AND ROUTINE_NAME = 'cleanDB'
			</sqlCheck>
		</preConditions>
		<sqlFile
				path="/src/main/resources/liquibase/procedures/cleanDB.sql"/>
	</changeSet>

	<changeSet id="Create procedure spCadenasServicesConfigs" author="DAS-Team" runAlways="true"
			   runOnChange="true">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">
				SELECT COUNT(*)
				FROM information_schema.routines
				WHERE ROUTINE_TYPE = 'PROCEDURE'
				AND SPECIFIC_CATALOG = 'db_indec_service'
				AND ROUTINE_NAME = 'spCadenasServicesConfigs'
			</sqlCheck>
		</preConditions>
		<sqlFile
				path="/src/main/resources/liquibase/procedures/spCadenasServicesConfigs.sql"/>
	</changeSet>

	<changeSet id="Create procedure spCategoriasProducto" author="DAS-Team" runAlways="true"
			   runOnChange="true">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">
				SELECT COUNT(*)
				FROM information_schema.routines
				WHERE ROUTINE_TYPE = 'PROCEDURE'
				AND SPECIFIC_CATALOG = 'db_indec_service'
				AND ROUTINE_NAME = 'spCategoriasProducto'
			</sqlCheck>
		</preConditions>
		<sqlFile
				path="/src/main/resources/liquibase/procedures/spCategoriasProducto.sql"/>
	</changeSet>

	<changeSet id="Create procedure spProductos" author="DAS-Team" runAlways="true"
			   runOnChange="true">
		<preConditions onFail="MARK_RAN">
			<sqlCheck expectedResult="0">
				SELECT COUNT(*)
				FROM information_schema.routines
				WHERE ROUTINE_TYPE = 'PROCEDURE'
				AND SPECIFIC_CATALOG = 'db_indec_service'
				AND ROUTINE_NAME = 'spProductos'
			</sqlCheck>
		</preConditions>
		<sqlFile
				path="/src/main/resources/liquibase/procedures/spProductos.sql"/>
	</changeSet>

</databaseChangeLog>